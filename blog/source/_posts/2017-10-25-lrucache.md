---
title: LruCache原理分析
date: 2017-10-25 16:03:26
categories: android
tags:
  - android
  - LruCache
  - 原理剖析
---

[LruCache](https://developer.android.google.cn/reference/android/util/LruCache.html)这个类在我们现在应用的开发中已经被普遍使用了，今天我们就深度解析这个类，从原理上掌握作者的设计思想以及实现原理

# 什么是LruCache

借官方的描述，LruCache就是一个持有一定数量强引用数据的缓存。当访问一个数据时，这个数据就会被移动到数据队列的头部(经常用到的数据)，当数据添加到缓存满时，队列尾部的数据(也就是不常用到的数据)会被删除并被回收，这就是LruCache的定义，同时这其中也包含了它的实现思想，采用了[LRU](https://baike.baidu.com/item/LRU/1269842?fr=aladdin)算法用来管理数据。

# LruCache能做什么

在我们平时的开发中，这个用的最多的就是缓存内存图片了，这里我就不在啰嗦，具体实例[官方文档](https://developer.android.google.cn/topic/performance/graphics/manage-memory.html)已经很详细了,我在这里要说的是，这个不一定用来缓存Bitmap,程序设计中凡是涉及LRU思想的逻辑的实现,都可以使用LruCache。

# LruCache原理解析

下面就让我们从源码的角度去解析LruCache的实现

## LruCache的成员变量

{% codeblock LruCache.java lang:java %}
    private final LinkedHashMap<K, V> map; //LruCache中的数据存储结构是LinkedHashMap

    /** Size of this cache in units. Not necessarily the number of elements. */
    private int size; //参考注释，这个只是个单位数，并不是指Map中数据的个数，比如我们缓存Bitmap时,可以定义成Bitmap的大小，单位可以是KB,MB等；但是我们也可以按数量来缓存，比如一个Bitmap，就是1等
    private int maxSize; //缓存的最大单位数，这个表示数据的单位要和size统一

    private int putCount; //添加数据的次数
    private int createCount; //创建数据的次数
    private int evictionCount; //删除数据的次数
    private int hitCount; //从缓存中找到数据的次数
    private int missCount; //从缓存中没有找到数据的次数
{% endcodeblock %}
